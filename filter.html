<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Foto Sederhana</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #2563eb;
            cursor: pointer;
            border-radius: 50%;
        }
        input[type=range]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #2563eb;
            cursor: pointer;
            border-radius: 50%;
        }
        #imageDisplay {
            min-height: 400px;
            background-color: #161b22;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #editableImage {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: filter 0.2s ease-out;
        }
        /* Kelas sketch-image dihapus karena filter sketsa telah dihapus */
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-blue-400">Editor Foto Minimalis Lanjutan</h1>
            <p class="text-center text-gray-400">Unggah gambar Anda dan terapkan filter!</p>
        </header>

        <div class="flex flex-col lg:flex-row gap-6">

            <div id="imageDisplay" class="lg:w-3/4 rounded-xl shadow-2xl p-4">
                <input type="file" id="imageUploader" accept="image/*" class="hidden">
                <label for="imageUploader" id="uploadLabel" class="cursor-pointer text-center p-12 border-4 border-dashed border-gray-600 rounded-lg transition hover:border-blue-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto mb-2 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                    </svg>
                    <span class="text-lg font-semibold text-gray-400">Klik untuk Unggah Gambar</span>
                </label>
                <img id="editableImage" src="" alt="Gambar yang Diedit" class="hidden">
            </div>

            <div id="controlsContainer" class="lg:w-1/4 bg-[#161b22] p-6 rounded-xl shadow-2xl space-y-6 opacity-50 pointer-events-none transition-opacity duration-300">
                
                <h2 class="text-xl font-semibold border-b border-gray-700 pb-3 mb-4">Pengaturan Lanjutan</h2>

                <div class="space-y-3">
                    <button id="cinematicFilterBtn" class="w-full py-2 px-4 rounded-lg font-bold bg-blue-600 hover:bg-blue-700 transition duration-150 shadow-md">
                        Terapkan Filter Sinematik
                    </button>
                    <p id="cinematicStatus" class="text-sm text-center text-gray-400">Status: Nonaktif</p>
                </div>
                
                <div class="space-y-2">
                    <label for="sepiaSlider" class="block text-sm font-medium">Sepia (<span id="sepiaValue">0</span>%)</label>
                    <input type="range" id="sepiaSlider" min="0" max="100" value="0" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="space-y-2">
                    <label for="hueSlider" class="block text-sm font-medium">Rotasi Warna (Hue) (<span id="hueValue">0</span>Â°)</label>
                    <input type="range" id="hueSlider" min="0" max="360" value="0" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <div class="space-y-2">
                    <label for="blurSlider" class="block text-sm font-medium">Efek Blur (<span id="blurValue">0.0</span>px)</label>
                    <input type="range" id="blurSlider" min="0" max="10" value="0" step="0.1" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="space-y-2">
                    <label for="contrastSlider" class="block text-sm font-medium">Kontras (<span id="contrastValue">100</span>%)</label>
                    <input type="range" id="contrastSlider" min="0" max="200" value="100" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="space-y-2">
                    <label for="saturationSlider" class="block text-sm font-medium">Saturasi Warna (<span id="saturationValue">100</span>%)</label>
                    <input type="range" id="saturationSlider" min="0" max="200" value="100" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="space-y-2">
                    <label for="brightnessSlider" class="block text-sm font-medium">Kecerahan (<span id="brightnessValue">100</span>%)</label>
                    <input type="range" id="brightnessSlider" min="50" max="150" value="100" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <button id="resetBtn" class="w-full py-2 px-4 rounded-lg font-bold bg-gray-700 hover:bg-gray-600 transition duration-150">
                    Reset Semua
                </button>

                <button id="saveBtn" class="w-full py-2 px-4 rounded-lg font-bold bg-green-600 hover:bg-green-700 transition duration-150 shadow-md mt-4">
                    Simpan Gambar
                </button>
            </div>
        </div>

    </div>

    <script>
        const imageUploader = document.getElementById('imageUploader');
        const editableImage = document.getElementById('editableImage');
        const uploadLabel = document.getElementById('uploadLabel');
        const controlsContainer = document.getElementById('controlsContainer');
        
        const contrastSlider = document.getElementById('contrastSlider');
        const saturationSlider = document.getElementById('saturationSlider');
        const brightnessSlider = document.getElementById('brightnessSlider');
        const hueSlider = document.getElementById('hueSlider');
        const blurSlider = document.getElementById('blurSlider');
        const sepiaSlider = document.getElementById('sepiaSlider'); // Tambahan Sepia
        
        const contrastValueSpan = document.getElementById('contrastValue');
        const saturationValueSpan = document.getElementById('saturationValue');
        const brightnessValueSpan = document.getElementById('brightnessValue');
        const hueValueSpan = document.getElementById('hueValue');
        const blurValueSpan = document.getElementById('blurValue');
        const sepiaValueSpan = document.getElementById('sepiaValue'); // Tambahan Sepia
        
        const cinematicFilterBtn = document.getElementById('cinematicFilterBtn');
        const cinematicStatusSpan = document.getElementById('cinematicStatus');
        const resetBtn = document.getElementById('resetBtn');
        const saveBtn = document.getElementById('saveBtn');

        let currentFilters = {
            contrast: 100,
            saturation: 100,
            brightness: 100,
            hueRotate: 0,
            blur: 0,
            sepia: 0, // Nilai default Sepia
            isCinematic: false,
        };

        // Filter Sinematik yang diperbarui, menghilangkan Sepia statis
        const CINEMATIC_CSS = 'hue-rotate(-5deg) saturate(1.1) brightness(0.9)'; 

        function applyFilters() {
            let filterString = '';

            if (currentFilters.isCinematic) {
                filterString += CINEMATIC_CSS + ' ';
            }
            
            filterString += `contrast(${currentFilters.contrast / 100}) `;
            filterString += `saturate(${currentFilters.saturation / 100}) `;
            filterString += `brightness(${currentFilters.brightness / 100}) `;
            filterString += `hue-rotate(${currentFilters.hueRotate}deg) `;
            filterString += `blur(${currentFilters.blur}px) `;
            filterString += `sepia(${currentFilters.sepia / 100}) `; // Terapkan Sepia

            editableImage.style.filter = filterString.trim();
        }

        function resetFilters() {
            currentFilters = {
                contrast: 100,
                saturation: 100,
                brightness: 100,
                hueRotate: 0,
                blur: 0,
                sepia: 0, // Reset Sepia
                isCinematic: false,
            };

            contrastSlider.value = 100;
            saturationSlider.value = 100;
            brightnessSlider.value = 100;
            hueSlider.value = 0;
            blurSlider.value = 0;
            sepiaSlider.value = 0; // Reset Sepia Slider
            
            contrastValueSpan.textContent = 100;
            saturationValueSpan.textContent = 100;
            brightnessValueSpan.textContent = 100;
            hueValueSpan.textContent = 0;
            blurValueSpan.textContent = '0.0';
            sepiaValueSpan.textContent = 0; // Reset Sepia Value

            // Reset Cinematic UI
            cinematicFilterBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
            cinematicFilterBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            cinematicFilterBtn.textContent = 'Terapkan Filter Sinematik';
            cinematicStatusSpan.textContent = 'Status: Nonaktif';

            applyFilters();
        }

        function saveImage() {
            if (editableImage.src === '') {
                console.error('Silakan unggah gambar terlebih dahulu.');
                return;
            }

            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                
                const currentFilterString = editableImage.style.filter;
                ctx.filter = currentFilterString;

                ctx.drawImage(img, 0, 0);

                const dataURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = 'foto-edit-' + new Date().getTime() + '.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };
            img.crossOrigin = 'Anonymous';
            img.src = editableImage.src;
        }

        imageUploader.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    editableImage.src = e.target.result;
                    
                    uploadLabel.classList.add('hidden');
                    editableImage.classList.remove('hidden');

                    controlsContainer.classList.remove('opacity-50', 'pointer-events-none');
                    
                    resetFilters();
                };
                reader.readAsDataURL(file);
            }
        });

        contrastSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            currentFilters.contrast = value;
            contrastValueSpan.textContent = value;
            applyFilters();
        });

        saturationSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            currentFilters.saturation = value;
            saturationValueSpan.textContent = value;
            applyFilters();
        });
        
        brightnessSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            currentFilters.brightness = value;
            brightnessValueSpan.textContent = value;
            applyFilters();
        });

        hueSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            currentFilters.hueRotate = value;
            hueValueSpan.textContent = value;
            applyFilters();
        });
        
        blurSlider.addEventListener('input', (e) => {
            const value = parseFloat(e.target.value).toFixed(1);
            currentFilters.blur = parseFloat(value);
            blurValueSpan.textContent = value;
            applyFilters();
        });

        // Event Listener untuk Sepia
        sepiaSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            currentFilters.sepia = value;
            sepiaValueSpan.textContent = value;
            applyFilters();
        });


        cinematicFilterBtn.addEventListener('click', () => {
            currentFilters.isCinematic = !currentFilters.isCinematic;

            if (currentFilters.isCinematic) {
                // Aktifkan Sinematik
                cinematicFilterBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                cinematicFilterBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                cinematicFilterBtn.textContent = 'Hapus Filter Sinematik';
                cinematicStatusSpan.textContent = 'Status: Aktif';
                
            } else {
                // Nonaktifkan Sinematik
                cinematicFilterBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                cinematicFilterBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                cinematicFilterBtn.textContent = 'Terapkan Filter Sinematik';
                cinematicStatusSpan.textContent = 'Status: Nonaktif';
            }

            applyFilters();
        });
        
        resetBtn.addEventListener('click', resetFilters);
        saveBtn.addEventListener('click', saveImage);
    </script>
</body>
</html>
